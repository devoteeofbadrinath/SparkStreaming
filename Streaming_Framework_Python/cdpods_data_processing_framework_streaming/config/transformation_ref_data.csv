pipeline_task_id,pipeline_name,pipeline_task_name,query_order,transformation_type,database_type,sql_query,temp_table_name,read_in_batches,version,last_updated,last_updated_by
account_balance_pipeline_name_pipeline_task_name,account_balance_pipeline_name,pipeline_task_name,1,transform,sparksql,"SELECT MessageHeader.*, MessageBody.* FROM Global_Temp.parsed_df",parsed_df_1,,1,2023--11-04,c138147
account_balance_pipeline_name_pipeline_task_name,account_balance_pipeline_name,pipeline_task_name,2,transform,sparksql,"SELECT pd1.*, AccArr.*, Branch.* FROM parsed_df_1 pd1",parsed_df_2,,1,2023--11-04,c138147
account_balance_pipeline_name_pipeline_task_name,account_balance_pipeline_name,pipeline_task_name,3,transform,sparksql,"SELECT Timestamp, BusCorID, LocRefNum, RetAdd, SeqNum, ReqRef, OriSou, EventAction,AccNum, Balance, BalanceStatus, NSC FROM parsed_df_2 ",source_df,,1,2023--11-04,c138147
account_balance_pipeline_name_pipeline_task_name,account_balance_pipeline_name,pipeline_task_name,4,transform,sparksql,"select * from ( select *, row_number() over (partition by AccNum, NSC order by timestamp desc) as rn from source_df ) tmp where rn = 1",source_df_with_latest_accounts,,1,2023--11-04,c138147
account_balance_pipeline_name_pipeline_task_name,account_balance_pipeline_name,pipeline_task_name,5,transform,pheonix,ODS_USECASE_REFERENCE_FILES.ACNT,existing_df_full,,1,2023--11-04,c138147