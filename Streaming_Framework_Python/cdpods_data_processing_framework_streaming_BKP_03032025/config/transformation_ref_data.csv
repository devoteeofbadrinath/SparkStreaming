pipeline_task_id,pipeline_name,pipeline_task_name,query_order,database_type,sql_query,temp_table_name,read_in_batches,version,last_updated,last_updated_by
account_balance_pipeline_name_pipeline_task_name,account_balance_pipeline_name,pipeline_task_name,1,sparksql,"select * from ( select *, row_number() over (partition by AccNum, NSC order by timestamp desc) as rn from source_df ) tmp where rn = 1",source_df_with_latest_accounts,,1,2023--11-04,c138147
account_balance_pipeline_name_pipeline_task_name,account_balance_pipeline_name,pipeline_task_name,2,pheonix,ODS_USECASE_REFERENCE_FILES.ACNT,existing_df_full,,1,2023--11-04,c138147

Timestamp,BusCorID,LocRefNum,RetAdd,SeqNum,ReqRef,OriSou,EventAction,partition,offset,AccNum,Balance,BalanceStatus,NSC